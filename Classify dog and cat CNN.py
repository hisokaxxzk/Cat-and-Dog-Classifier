{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":3389,"status":"ok","timestamp":1681045213891,"user":{"displayName":"Thịnh Trần","userId":"04492095225491445902"},"user_tz":-420},"id":"fq1gInpXoTos"},"outputs":[],"source":["from tensorflow.keras import Sequential\n","from tensorflow.keras.layers import Conv2D\n","from tensorflow.keras.layers import MaxPooling2D\n","from tensorflow.keras.layers import Flatten\n","from tensorflow.keras import layers\n","from tensorflow.keras.layers import Dense\n","from tensorflow.keras.preprocessing.image import ImageDataGenerator\n","from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint\n","from datetime import datetime\n","import pandas as pd\n","from tensorflow.keras.utils import plot_model\n","from IPython.display import Image\n","from tensorflow.keras.models import load_model"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"onPe8ZFUHhSJ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1681045242736,"user_tz":-420,"elapsed":28847,"user":{"displayName":"Thịnh Trần","userId":"04492095225491445902"}},"outputId":"e9a38615-1cb9-4a35-c010-cd2c995a3bb4"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found 8020 images belonging to 2 classes.\n","Found 2000 images belonging to 2 classes.\n"]}],"source":["train_data = ImageDataGenerator(\n","    rescale = 1./255,\n","    shear_range = 0.2,\n","    zoom_range = 0.2,\n","    horizontal_flip = True\n",")\n","test_data = ImageDataGenerator(rescale = 1./255)\n","trainning_set = train_data.flow_from_directory('/content/drive/MyDrive/Colab Notebooks/Classify dog and cat CNN/training_set',\n","                                               target_size = (64,64),\n","                                               batch_size = 32,\n","                                               class_mode = 'binary',)\n","test_set = test_data.flow_from_directory('/content/drive/MyDrive/Colab Notebooks/Classify dog and cat CNN/test_set',\n","                                               target_size = (64,64),\n","                                               batch_size = 32,\n","                                               class_mode = 'binary',)\n"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":3777,"status":"ok","timestamp":1681045246511,"user":{"displayName":"Thịnh Trần","userId":"04492095225491445902"},"user_tz":-420},"id":"UPcVbfd3qVzQ"},"outputs":[],"source":["classifier = Sequential([\n","    Conv2D(filters=64,kernel_size = 3, input_shape = (64,64,3),activation = 'relu'),\n","    MaxPooling2D(pool_size = (2,2)),\n","    layers.Dropout(0.3),\n","    Conv2D(filters=64,kernel_size = 3,activation = 'relu'),\n","    MaxPooling2D(pool_size = (2,2)),\n","    layers.Dropout(0.3),\n","    Flatten(),\n","    Dense(units = 256, activation = 'relu'),\n","    Dense (units = 1, activation = 'sigmoid')\n","])\n"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":13,"status":"ok","timestamp":1681045246512,"user":{"displayName":"Thịnh Trần","userId":"04492095225491445902"},"user_tz":-420},"id":"rHLoCUth7AjG"},"outputs":[],"source":["classifier.compile('adam','binary_crossentropy',metrics = ['accuracy'])"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3qgUE98sQVyU","outputId":"cbd63fef-ed5a-4154-e67b-da65f69ab248","executionInfo":{"status":"ok","timestamp":1681049507053,"user_tz":-420,"elapsed":4260553,"user":{"displayName":"Thịnh Trần","userId":"04492095225491445902"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["2023-04-09 13:00:45.118321\n","Epoch 1/200\n","251/251 [==============================] - 1287s 5s/step - loss: 0.7067 - accuracy: 0.5079 - val_loss: 0.6788 - val_accuracy: 0.5640\n","Epoch 2/200\n","251/251 [==============================] - 50s 199ms/step - loss: 0.6793 - accuracy: 0.5670 - val_loss: 0.6632 - val_accuracy: 0.6100\n","Epoch 3/200\n","251/251 [==============================] - 51s 203ms/step - loss: 0.6577 - accuracy: 0.6095 - val_loss: 0.6337 - val_accuracy: 0.6475\n","Epoch 4/200\n","251/251 [==============================] - 50s 199ms/step - loss: 0.6370 - accuracy: 0.6390 - val_loss: 0.5997 - val_accuracy: 0.6810\n","Epoch 5/200\n","251/251 [==============================] - 50s 200ms/step - loss: 0.6143 - accuracy: 0.6633 - val_loss: 0.5830 - val_accuracy: 0.7005\n","Epoch 6/200\n","251/251 [==============================] - 50s 200ms/step - loss: 0.5877 - accuracy: 0.6857 - val_loss: 0.5716 - val_accuracy: 0.7150\n","Epoch 7/200\n","251/251 [==============================] - 53s 211ms/step - loss: 0.5765 - accuracy: 0.6963 - val_loss: 0.5707 - val_accuracy: 0.7120\n","Epoch 8/200\n","251/251 [==============================] - 51s 202ms/step - loss: 0.5493 - accuracy: 0.7190 - val_loss: 0.5394 - val_accuracy: 0.7430\n","Epoch 9/200\n","251/251 [==============================] - 51s 203ms/step - loss: 0.5298 - accuracy: 0.7333 - val_loss: 0.5215 - val_accuracy: 0.7580\n","Epoch 10/200\n","251/251 [==============================] - 50s 199ms/step - loss: 0.5104 - accuracy: 0.7481 - val_loss: 0.5047 - val_accuracy: 0.7580\n","Epoch 11/200\n","251/251 [==============================] - 50s 201ms/step - loss: 0.4923 - accuracy: 0.7595 - val_loss: 0.5078 - val_accuracy: 0.7520\n","Epoch 12/200\n","251/251 [==============================] - 51s 204ms/step - loss: 0.4863 - accuracy: 0.7612 - val_loss: 0.4851 - val_accuracy: 0.7750\n","Epoch 13/200\n","251/251 [==============================] - 53s 211ms/step - loss: 0.4698 - accuracy: 0.7748 - val_loss: 0.4790 - val_accuracy: 0.7770\n","Epoch 14/200\n","251/251 [==============================] - 51s 203ms/step - loss: 0.4559 - accuracy: 0.7878 - val_loss: 0.4690 - val_accuracy: 0.7780\n","Epoch 15/200\n","251/251 [==============================] - 53s 211ms/step - loss: 0.4339 - accuracy: 0.7910 - val_loss: 0.4745 - val_accuracy: 0.7805\n","Epoch 16/200\n","251/251 [==============================] - 50s 199ms/step - loss: 0.4207 - accuracy: 0.8026 - val_loss: 0.4726 - val_accuracy: 0.7955\n","Epoch 17/200\n","251/251 [==============================] - 50s 200ms/step - loss: 0.4057 - accuracy: 0.8136 - val_loss: 0.4837 - val_accuracy: 0.7755\n","Epoch 18/200\n","251/251 [==============================] - 52s 208ms/step - loss: 0.3893 - accuracy: 0.8226 - val_loss: 0.4732 - val_accuracy: 0.7965\n","Epoch 19/200\n","251/251 [==============================] - 50s 198ms/step - loss: 0.3855 - accuracy: 0.8262 - val_loss: 0.4761 - val_accuracy: 0.7835\n","Epoch 20/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.3722 - accuracy: 0.8292 - val_loss: 0.4676 - val_accuracy: 0.7855\n","Epoch 21/200\n","251/251 [==============================] - 50s 200ms/step - loss: 0.3530 - accuracy: 0.8414 - val_loss: 0.4444 - val_accuracy: 0.8015\n","Epoch 22/200\n","251/251 [==============================] - 49s 194ms/step - loss: 0.3328 - accuracy: 0.8521 - val_loss: 0.4719 - val_accuracy: 0.8050\n","Epoch 23/200\n","251/251 [==============================] - 50s 198ms/step - loss: 0.3276 - accuracy: 0.8541 - val_loss: 0.4841 - val_accuracy: 0.7910\n","Epoch 24/200\n","251/251 [==============================] - 49s 194ms/step - loss: 0.3018 - accuracy: 0.8723 - val_loss: 0.5246 - val_accuracy: 0.7855\n","Epoch 25/200\n","251/251 [==============================] - 50s 198ms/step - loss: 0.2930 - accuracy: 0.8729 - val_loss: 0.4717 - val_accuracy: 0.8060\n","Epoch 26/200\n","251/251 [==============================] - 52s 207ms/step - loss: 0.2865 - accuracy: 0.8810 - val_loss: 0.5025 - val_accuracy: 0.7860\n","Epoch 27/200\n","251/251 [==============================] - 49s 194ms/step - loss: 0.2681 - accuracy: 0.8855 - val_loss: 0.4968 - val_accuracy: 0.7920\n","Epoch 28/200\n","251/251 [==============================] - 50s 198ms/step - loss: 0.2520 - accuracy: 0.8956 - val_loss: 0.4924 - val_accuracy: 0.7915\n","Epoch 29/200\n","251/251 [==============================] - 49s 194ms/step - loss: 0.2478 - accuracy: 0.8970 - val_loss: 0.5330 - val_accuracy: 0.7795\n","Epoch 30/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.2372 - accuracy: 0.9034 - val_loss: 0.5044 - val_accuracy: 0.7975\n","Epoch 31/200\n","251/251 [==============================] - 49s 195ms/step - loss: 0.2211 - accuracy: 0.9100 - val_loss: 0.5193 - val_accuracy: 0.7945\n","Epoch 32/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.2097 - accuracy: 0.9175 - val_loss: 0.5381 - val_accuracy: 0.7960\n","Epoch 33/200\n","251/251 [==============================] - 52s 206ms/step - loss: 0.2127 - accuracy: 0.9165 - val_loss: 0.5303 - val_accuracy: 0.7995\n","Epoch 34/200\n","251/251 [==============================] - 49s 195ms/step - loss: 0.2033 - accuracy: 0.9171 - val_loss: 0.5658 - val_accuracy: 0.8010\n","Epoch 35/200\n","251/251 [==============================] - 50s 197ms/step - loss: 0.1876 - accuracy: 0.9246 - val_loss: 0.5611 - val_accuracy: 0.7885\n","Epoch 36/200\n","251/251 [==============================] - 49s 196ms/step - loss: 0.1814 - accuracy: 0.9288 - val_loss: 0.5886 - val_accuracy: 0.7885\n","Epoch 37/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.1625 - accuracy: 0.9368 - val_loss: 0.5927 - val_accuracy: 0.7950\n","Epoch 38/200\n","251/251 [==============================] - 48s 193ms/step - loss: 0.1818 - accuracy: 0.9318 - val_loss: 0.5704 - val_accuracy: 0.7995\n","Epoch 39/200\n","251/251 [==============================] - 50s 198ms/step - loss: 0.1669 - accuracy: 0.9350 - val_loss: 0.5930 - val_accuracy: 0.7895\n","Epoch 40/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.1552 - accuracy: 0.9404 - val_loss: 0.6157 - val_accuracy: 0.7980\n","Epoch 41/200\n","251/251 [==============================] - 49s 194ms/step - loss: 0.1485 - accuracy: 0.9418 - val_loss: 0.6001 - val_accuracy: 0.7915\n","Epoch 42/200\n","251/251 [==============================] - 49s 196ms/step - loss: 0.1458 - accuracy: 0.9454 - val_loss: 0.5909 - val_accuracy: 0.8020\n","Epoch 43/200\n","251/251 [==============================] - 50s 198ms/step - loss: 0.1335 - accuracy: 0.9494 - val_loss: 0.6388 - val_accuracy: 0.7920\n","Epoch 44/200\n","251/251 [==============================] - 48s 191ms/step - loss: 0.1339 - accuracy: 0.9491 - val_loss: 0.6384 - val_accuracy: 0.7935\n","Epoch 45/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.1296 - accuracy: 0.9531 - val_loss: 0.6937 - val_accuracy: 0.7940\n","Epoch 46/200\n","251/251 [==============================] - 51s 205ms/step - loss: 0.1326 - accuracy: 0.9484 - val_loss: 0.7225 - val_accuracy: 0.7810\n","Epoch 47/200\n","251/251 [==============================] - 48s 193ms/step - loss: 0.1288 - accuracy: 0.9532 - val_loss: 0.7090 - val_accuracy: 0.7940\n","Epoch 48/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.1267 - accuracy: 0.9542 - val_loss: 0.7083 - val_accuracy: 0.7840\n","Epoch 49/200\n","251/251 [==============================] - 49s 195ms/step - loss: 0.1250 - accuracy: 0.9515 - val_loss: 0.6444 - val_accuracy: 0.8020\n","Epoch 50/200\n","251/251 [==============================] - 49s 197ms/step - loss: 0.1076 - accuracy: 0.9572 - val_loss: 0.7240 - val_accuracy: 0.7980\n","Epoch 51/200\n","251/251 [==============================] - 51s 204ms/step - loss: 0.1166 - accuracy: 0.9579 - val_loss: 0.7195 - val_accuracy: 0.8005\n","2023-04-09 14:11:45.022743\n"]}],"source":["import datetime\n","callbacks = [EarlyStopping(monitor = 'val_loss', \n","                           patience = 30),\n","              ModelCheckpoint('/content/drive/MyDrive/Colab Notebooks/Classify dog and cat CNN/model_checkpoint_classdogcat.h5',\n","                            save_best_only=True)\n","            ]\n","print (datetime.datetime.now())\n","history = classifier.fit(trainning_set,\n","                           epochs=200,\n","                           validation_data = test_set,\n","                           callbacks = callbacks\n","                           )\n","print (datetime.datetime.now())"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"GNM3DgEIYiTt","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1681049507054,"user_tz":-420,"elapsed":17,"user":{"displayName":"Thịnh Trần","userId":"04492095225491445902"}},"outputId":"aa925d61-4b7d-4268-8516-ecf49937dacf"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["        loss  accuracy  val_loss  val_accuracy\n","46  0.128764  0.953242  0.709038        0.7940\n","47  0.126745  0.954239  0.708270        0.7840\n","48  0.124965  0.951496  0.644423        0.8020\n","49  0.107628  0.957232  0.723975        0.7980\n","50  0.116578  0.957855  0.719537        0.8005"],"text/html":["\n","  <div id=\"df-b9638788-acde-4a81-8986-12041be77d88\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>loss</th>\n","      <th>accuracy</th>\n","      <th>val_loss</th>\n","      <th>val_accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>46</th>\n","      <td>0.128764</td>\n","      <td>0.953242</td>\n","      <td>0.709038</td>\n","      <td>0.7940</td>\n","    </tr>\n","    <tr>\n","      <th>47</th>\n","      <td>0.126745</td>\n","      <td>0.954239</td>\n","      <td>0.708270</td>\n","      <td>0.7840</td>\n","    </tr>\n","    <tr>\n","      <th>48</th>\n","      <td>0.124965</td>\n","      <td>0.951496</td>\n","      <td>0.644423</td>\n","      <td>0.8020</td>\n","    </tr>\n","    <tr>\n","      <th>49</th>\n","      <td>0.107628</td>\n","      <td>0.957232</td>\n","      <td>0.723975</td>\n","      <td>0.7980</td>\n","    </tr>\n","    <tr>\n","      <th>50</th>\n","      <td>0.116578</td>\n","      <td>0.957855</td>\n","      <td>0.719537</td>\n","      <td>0.8005</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b9638788-acde-4a81-8986-12041be77d88')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b9638788-acde-4a81-8986-12041be77d88 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b9638788-acde-4a81-8986-12041be77d88');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}],"source":["pd.DataFrame(history.history).tail()"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"knKq8ba5YsG6","executionInfo":{"status":"ok","timestamp":1681049507721,"user_tz":-420,"elapsed":680,"user":{"displayName":"Thịnh Trần","userId":"04492095225491445902"}}},"outputs":[],"source":["classifier.save(\"/content/drive/MyDrive/Colab Notebooks/Classify dog and cat CNN/dog_and_cat.h5\")"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[],"mount_file_id":"1TE3O7Goeyni_2j-2E6uukiPOqlwWhZuX","authorship_tag":"ABX9TyMvXn+pxKQmc99caveqlAVF"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}